name: auto-deploy
on: [push]
jobs:
  archive-file:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: get version
        id: version
        uses: notiz-dev/github-action-json-property@release
        with:
          path: 'version.json'
          prop_path: 'version'
      
      - name: action-zip
        uses: montudor/action-zip@v0.1.1
        with:
          args: zip -qq -r blinker-py-${{steps.version.outputs.prop}}.zip . -x .github/* -x .git/*
      
      - name: ls dir
        run: ls *.zip

      # - name: Deploy
      #   uses: garygrossgarten/github-action-scp@v0.5.3
      #   with:
      #     local: blinker-py.zip
      #     remote: /home/ubuntu/blinker-py.zip
      #     host: ${{ secrets.SERVER_IP }}
      #     username: ubuntu
      #     privateKey: ${{ secrets.SSH_PRIVATE_KEY }}
      #     recursive: true